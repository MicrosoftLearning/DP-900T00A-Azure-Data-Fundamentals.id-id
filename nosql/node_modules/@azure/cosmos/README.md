---
ms.openlocfilehash: 3e62289181d994a0e786bb53417f576ac1a3059b
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: id-ID
ms.lasthandoff: 02/05/2022
ms.locfileid: "138051538"
---
# <a name="azure-cosmos-db-client-library-for-javascripttypescript"></a>Pustaka klien Azure Cosmos DB untuk JavaScript/TypeScript

[![lencana npm terbaru](https://img.shields.io/npm/v/%40azure%2Fcosmos/latest.svg)][npm]
[![Status Build](https://dev.azure.com/azure-sdk/public/_apis/build/status/js/js%20-%20cosmosdb%20-%20ci?branchName=main)](https://dev.azure.com/azure-sdk/public/_build/latest?definitionId=850&branchName=main)

Azure Cosmos DB adalah layanan database multi model yang didistribusikan secara global yang mendukung database dokumen, nilai kunci, kolom lebar, dan grafik. Paket ini ditujukan untuk aplikasi JavaScript/TypeScript untuk berinteraksi dengan database **API SQL** dan dokumen JSON yang dimiliki oleh database:

- Membuat database Cosmos DB dan mengubah pengaturannya
- Membuat dan mengubah kontainer untuk menyimpan kumpulan dokumen JSON
- Membuat, membaca, memperbarui, dan menghapus item (dokumen JSON) di kontainer Anda
- Mengkueri dokumen dalam database Anda menggunakan sintaks seperti SQL

Tautan utama:

- [Paket (npm)][npm]
- [Dokumentasi referensi API](https://docs.microsoft.com/javascript/api/@azure/cosmos/?view=azure-node-lates)
- [Dokumentasi produk][cosmos_docs]

## <a name="getting-started"></a>Memulai

### <a name="prerequisites"></a>Prasyarat

#### <a name="azure-subscription-and-cosmos-db-sql-api-account"></a>Langganan Azure dan Akun API SQL Cosmos DB

Anda harus memiliki [Langganan Azure][azure_sub], dan [akun DB Cosmos][cosmos_account] (API SQL) untuk menggunakan paket ini.

Jika Anda memerlukan akun API SQL Cosmos DB, Anda dapat menggunakan Azure [Cloud Shell][cloud_shell_bash] untuk membuat akun dengan perintah Azure CLI ini:

```Bash
az cosmosdb create --resource-group <resource-group-name> --name <cosmos-database-account-name>
```

Atau Anda dapat membuat akun di [Portal Azure](https://portal.azure.com/#create/microsoft.documentdb)

#### <a name="nodejs"></a>NodeJS

Paket ini didistribusikan melalui [npm][npm] yang telah diinstal sebelumnya dengan [NodeJS](https://nodejs.org/en/). Anda harus menggunakan Node v10 atau lebih tinggi.

#### <a name="cors"></a>CORS

Anda perlu menyiapkan aturan [Cross-Origin Resource Sharing (CORS)](https://docs.microsoft.com/azure/cosmos-db/how-to-configure-cross-origin-resource-sharing) untuk akun Cosmos DB jika Anda perlu mengembangkan untuk browser. Ikuti instruksi dalam dokumen tertaut untuk membuat aturan CORS baru untuk Cosmos DB Anda.

### <a name="install-this-package"></a>Menginstal paket ini

```Bash
npm install @azure/cosmos
```

### <a name="get-account-credentials"></a>Mendapatkan Kredensial Akun

Anda memerlukan **Titik Akhir Akun** dan **Kunci** Cosmos DB Anda. Anda dapat menemukannya di [Portal Azure](https://portal.azure.com/#blade/hubsextension/browseresource/resourcetype/microsoft.documentdb%2fdatabaseaccounts) atau menggunakan cuplikan [Azure CLI][azure_cli] di bawah. Cuplikan diformat untuk shell Bash.

```Bash
az cosmosdb show --resource-group <your-resource-group> --name <your-account-name> --query documentEndpoint --output tsv
az cosmosdb keys list --resource-group <your-resource-group> --name <your-account-name> --query documentEndpoint --output tsv
```

### <a name="create-an-instance-of-cosmosclient"></a>Membuat instans `CosmosClient`

Interaksi dengan Cosmos DB dimulai dengan instans kelas [CosmosClient](https://docs.microsoft.com/javascript/api/@azure/cosmos/cosmosclient?view=azure-node-latest)

```js
const { CosmosClient } = require("@azure/cosmos");

const endpoint = "https://your-account.documents.azure.com";
const key = "<database account masterkey>";
const client = new CosmosClient({ endpoint, key });

async function main() {
  // The rest of the README samples are designed to be pasted into this function body
}

main().catch((error) => {
  console.error(error);
});
```

Untuk kesederhanaan, kami telah menyertakan `key` dan `endpoint` secara langsung dalam kode, tetapi Anda mungkin perlu memuatnya dari file yang tidak berada dalam kontrol sumber menggunakan proyek seperti [dotenv](https://www.npmjs.com/package/dotenv) atau memuat dari variabel lingkungan

Di lingkungan produksi, rahasia seperti kunci harus disimpan di [Azure Key Vault](https://azure.microsoft.com/services/key-vault/)

## <a name="key-concepts"></a>Konsep utama

Setelah Anda menginisialisasi [CosmosClient](https://docs.microsoft.com/javascript/api/@azure/cosmos/cosmosclient?view=azure-node-lates), Anda dapat berinteraksi dengan jenis sumber daya utama di Cosmos DB:

- [Database](https://docs.microsoft.com/javascript/api/@azure/cosmos/database?view=azure-node-latest): Akun Cosmos DB dapat berisi banyak database. Saat membuat database, Anda menentukan API yang ingin Anda gunakan saat berinteraksi dengan dokumen database: SQL, MongoDB, Gremlin, Cassandra, atau Azure Table. Gunakan objek [Database](https://docs.microsoft.com/javascript/api/@azure/cosmos/database?view=azure-node-latest) untuk mengelola kontainer objek.

- [Kontainer](https://docs.microsoft.com/javascript/api/@azure/cosmos/container?view=azure-node-latest): Kontainer adalah kumpulan dokumen JSON. Anda membuat (menyisipkan), membaca, memperbarui, dan menghapus item dalam kontainer dengan menggunakan metode pada objek [Kontainer](https://docs.microsoft.com/javascript/api/@azure/cosmos/container?view=azure-node-latest).

- [Item](https://docs.microsoft.com/javascript/api/@azure/cosmos/item?view=azure-node-latest): Item adalah dokumen JSON yang disimpan dalam kontainer. Setiap Item harus menyertakan kunci `id` dengan nilai yang secara unik mengidentifikasi item di dalam kontainer. Jika Anda tidak menyediakan `id`, SDK akan membuatnya secara otomatis.

Untuk informasi selengkapnya tentang sumber daya ini, lihat [Bekerja dengan database, kontainer, dan item Azure Cosmos][cosmos_resources].

## <a name="examples"></a>Contoh

Bagian berikut menyediakan beberapa cuplikan kode yang mencakup beberapa tugas Cosmos DB yang paling umum, termasuk:

- [Membuat database](#create-a-database)
- [Membuat kontainer](#create-a-container)
- [Menyisipkan item](#insert-items)
- [Meminta dokumen](#query-the-database)
- [Membaca item](#read-an-item)
- [Menghapus item](#delete-an-data)

### <a name="create-a-database"></a>Buat database

Setelah mengautentikasi [CosmosClient](https://docs.microsoft.com/javascript/api/@azure/cosmos/cosmosclient?view=azure-node-latest), Anda dapat bekerja dengan semua sumber daya di akun. Cuplikan kode di bawah ini membuat database API SQL.

```js
const { database } = await client.databases.createIfNotExists({ id: "Test Database" });
console.log(database.id);
```

### <a name="create-a-container"></a>Buat kontainer

Contoh ini membuat kontainer dengan pengaturan default

```js
const { container } = await database.containers.createIfNotExists({ id: "Test Database" });
console.log(container.id);
```

### <a name="insert-items"></a>Menyisipkan item

Untuk menyisipkan item ke dalam kontainer, teruskan objek yang berisi data Anda ke [Items.upsert](https://docs.microsoft.com/javascript/api/@azure/cosmos/items?view=azure-node-latest#upsert-t--requestoptions-). Layanan Cosmos DB mengharuskan setiap item memiliki kunci `id`. Jika Anda tidak menyediakannya, SDK akan menghasilkan `id` secara otomatis.

Contoh ini menyisipkan beberapa item ke dalam kontainer

```js
const cities = [
  { id: "1", name: "Olympia", state: "WA", isCapitol: true },
  { id: "2", name: "Redmond", state: "WA", isCapitol: false },
  { id: "3", name: "Chicago", state: "IL", isCapitol: false }
];
for (const city of cities) {
  container.items.create(city);
}
```

### <a name="read-an-item"></a>Membaca item

Untuk membaca satu item dari kontainer, gunakan [Item.read](https://docs.microsoft.com/javascript/api/@azure/cosmos/item?view=azure-node-latest#read-requestoptions-). Hal ini merupakan operasi yang lebih murah daripada menggunakan SQL untuk mengkueri berdasarkan `id`.

```js
await container.item("1").read();
```

### <a name="delete-an-item"></a>Hapus item

Untuk menghapus item dari kontainer, gunakan [Item.delete](https://docs.microsoft.com/javascript/api/@azure/cosmos/item?view=azure-node-latest#delete-requestoptions-).

```js
// Delete the first item returned by the query above
await container.item("1").delete();
```

### <a name="query-the-database"></a>Mengkueri database

Database API SQL Cosmos DB mendukung dalam mengkueri item di kontainer dengan [Items.query](https://docs.microsoft.com/javascript/api/@azure/cosmos/items?view=azure-node-latest#query-string---sqlqueryspec--feedoptions-) menggunakan sintaks seperti SQL:

```js
const { resources } = await container.items
  .query("SELECT * from c WHERE c.isCapitol = true")
  .fetchAll();
for (const city of resources) {
  console.log(`${city.name}, ${city.state} is a capitol `);
}
```

Lakukan kueri berparameter dengan meneruskan objek yang berisi parameter dan nilai kueri ke [Items.query](https://docs.microsoft.com/javascript/api/@azure/cosmos/items?view=azure-node-latest#query-string---sqlqueryspec--feedoptions-):

```js
const { resources } = await container.items
  .query({
    query: "SELECT * from c WHERE c.isCapitol = @isCapitol",
    parameters: [{ name: "@isCapitol", value: true }]
  })
  .fetchAll();
for (const city of resources) {
  console.log(`${city.name}, ${city.state} is a capitol `);
}
```

Untuk informasi selengkapnya tentang mengkueri database Cosmos DB menggunakan API SQL, lihat [Mengkueri data Azure Cosmos DB dengan kueri SQL][cosmos_sql_queries].

## <a name="troubleshooting"></a>Pemecahan Masalah

### <a name="general"></a>Umum

Saat Anda berinteraksi dengan kesalahan Cosmos DB yang ditampilkan oleh layanan sesuai dengan kode status HTTP yang sama yang ditampilkan untuk permintaan REST API:

[Kode Status HTTP untuk Azure Cosmos DB][cosmos_http_status_codes]

#### <a name="conflicts"></a>Konflik

Misalnya, jika Anda mencoba membuat item menggunakan `id` yang sudah digunakan di database Cosmos DB Anda, kesalahan `409` akan ditampilkan, yang menunjukkan konflik. Dalam cuplikan berikut, kesalahan ditangani dengan baik dengan menangkap pengecualian dan menampilkan informasi tambahan tentang kesalahan tersebut.

```js
try {
  await containers.items.create({ id: "existing-item-id" });
} catch (error) {
  if (error.code === 409) {
    console.log("There was a conflict with an existing item");
  }
}
```

### <a name="transpiling"></a>Transpiling

Azure SDK dirancang untuk mendukung sintaks ES5 JavaScript dan [versi LTS dari Node.js](https://nodejs.org/about/releases/). Jika Anda memerlukan dukungan untuk runtime JavaScript sebelumnya seperti Internet Explorer atau Node 6, Anda perlu menerjemahkan kode SDK sebagai bagian dari proses pembangunan Anda.

### <a name="handle-transient-errors-with-retries"></a>Menangani kesalahan sementara dengan percobaan kembali

Saat bekerja dengan Cosmos DB, Anda mungkin mengalami kegagalan sementara yang disebabkan oleh [batas kecepatan][cosmos_request_units] yang diberlakukan oleh layanan, atau masalah sementara lainnya seperti pemadaman jaringan. Untuk informasi tentang penanganan jenis kegagalan ini, lihat [Coba lagi pola][azure_pattern_retry] di panduan Pola Desain Cloud, dan [pola Pemutus Sirkuit][azure_pattern_circuit_breaker] terkait.

## <a name="next-steps"></a>Langkah berikutnya

### <a name="more-sample-code"></a>Lebih banyak kode sampel

[Beberapa sampel][cosmos_samples] tersedia untuk Anda di repositori GitHub SDK. Sampel ini memberikan kode contoh untuk skenario tambahan yang biasa ditemui saat bekerja dengan Cosmos DB:

- Operasi Database.
- Operasi Kontainer
- Operasi Item
- Mengonfigurasi Pengindeksan
- Membaca Umpan Perubahan kontainer
- Prosedur Tersimpan
- Mengubah pengaturan throughput Database/Kontainer
- Operasi Penulisan Multi Wilayah

### <a name="additional-documentation"></a>Dokumentasi tambahan

Untuk dokumentasi yang lebih lengkap tentang layanan Cosmos DB, lihat [dokumentasi Azure Cosmos DB][cosmos_docs] di docs.microsoft.com.

## <a name="useful-links"></a>Tautan yang Berguna

- [Selamat datang di Microsoft Azure Cosmos DB](https://docs.microsoft.com/azure/cosmos-db/community)
- [Mulai cepat](https://docs.microsoft.com/azure/cosmos-db/sql-api-nodejs-get-started)
- [Tutorial](https://docs.microsoft.com/azure/cosmos-db/sql-api-nodejs-application)
- [Sampel](https://github.com/Azure/azure-sdk-for-js/tree/main/sdk/cosmosdb/cosmos/samples)
- [Pengantar tentang Model Sumber Daya Layanan Azure Cosmos DB](https://docs.microsoft.com/azure/cosmos-db/sql-api-resources)
- [Pengantar tentang API SQL Layanan Azure Cosmos DB](https://docs.microsoft.com/azure/cosmos-db/sql-api-sql-query)
- [Partisi](https://docs.microsoft.com/azure/cosmos-db/sql-api-partition-data)
- [Dokumentasi API](https://docs.microsoft.com/javascript/api/%40azure/cosmos/?view=azure-node-latest)

## <a name="contributing"></a>Berkontribusi

Jika Anda ingin berkontribusi pada pustaka ini, baca [panduan berkontribusi](https://github.com/Azure/azure-sdk-for-js/blob/main/CONTRIBUTING.md) untuk mempelajari selengkapnya tentang cara membuat dan menguji kode.

![Tayangan](https://azure-sdk-impressions.azurewebsites.net/api/impressions/azure-sdk-for-js%2Fsdk%2Fcosmosdb%2Fcosmos%2FREADME.png)

<!-- LINKS -->

[azure_cli]: https://docs.microsoft.com/cli/azure
[azure_pattern_circuit_breaker]: https://docs.microsoft.com/azure/architecture/patterns/circuit-breaker
[azure_pattern_retry]: https://docs.microsoft.com/azure/architecture/patterns/retry
[azure_portal]: https://portal.azure.com
[azure_sub]: https://azure.microsoft.com/free/
[cloud_shell]: https://docs.microsoft.com/azure/cloud-shell/overview
[cloud_shell_bash]: https://shell.azure.com/bash
[cosmos_account_create]: https://docs.microsoft.com/azure/cosmos-db/how-to-manage-database-account
[cosmos_account]: https://docs.microsoft.com/azure/cosmos-db/account-overview
[cosmos_container]: https://docs.microsoft.com/azure/cosmos-db/databases-containers-items#azure-cosmos-containers
[cosmos_database]: https://docs.microsoft.com/azure/cosmos-db/databases-containers-items#azure-cosmos-databases
[cosmos_docs]: https://docs.microsoft.com/azure/cosmos-db/
[cosmos_http_status_codes]: https://docs.microsoft.com/rest/api/cosmos-db/http-status-codes-for-cosmosdb
[cosmos_item]: https://docs.microsoft.com/azure/cosmos-db/databases-containers-items#azure-cosmos-items
[cosmos_request_units]: https://docs.microsoft.com/azure/cosmos-db/request-units
[cosmos_resources]: https://docs.microsoft.com/azure/cosmos-db/databases-containers-items
[cosmos_samples]: https://github.com/Azure/azure-sdk-for-js/tree/main/sdk/cosmosdb/cosmos/samples
[cosmos_sql_queries]: https://docs.microsoft.com/azure/cosmos-db/how-to-sql-query
[cosmos_ttl]: https://docs.microsoft.com/azure/cosmos-db/time-to-live
[npm]: https://www.npmjs.com/package/@azure/cosmos
